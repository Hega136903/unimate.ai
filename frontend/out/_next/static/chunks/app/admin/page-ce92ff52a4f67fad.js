(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{6181:(e,t,s)=>{Promise.resolve().then(s.bind(s,2242))},2242:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(5155),r=s(2115),l=s(6868),i=s(2818);let n=()=>{var e,t;let{user:s,isLoggedIn:n}=(0,l.A)(),o=i.env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api",[c,d]=(0,r.useState)("dashboard"),[h,m]=(0,r.useState)({totalPolls:0,activePolls:0,totalVotes:0,totalUsers:0}),[u,g]=(0,r.useState)([]),[x,p]=(0,r.useState)(!0),[f,y]=(0,r.useState)(null),[j,b]=(0,r.useState)(!1),[v,N]=(0,r.useState)({title:"",description:"",category:"campus-decision",isAnonymous:!0,startTime:"",endTime:"",options:[{text:"",description:""},{text:"",description:""}]});(0,r.useEffect)(()=>{b(!0)},[]),(0,r.useEffect)(()=>{if(!j)return;console.log("\uD83D\uDD0D AdminPanel Auth Check:",{isLoggedIn:n,user:s});let e=localStorage.getItem("token"),t=localStorage.getItem("user"),a=t?JSON.parse(t):null;if(console.log("\uD83D\uDD0D localStorage data:",{token:!!e,userData:a}),!n&&!e){console.log("❌ No authentication found, redirecting to home"),window.location.href="/";return}let r=s||a;if(r&&"admin"!==r.role){console.log("❌ Not an admin user, redirecting to home"),window.location.href="/";return}console.log("✅ Admin authentication passed")},[s,n,j]),(0,r.useEffect)(()=>{(null==s?void 0:s.role)==="admin"&&E()},[s]);let w=j?localStorage.getItem("token"):null,A=j?localStorage.getItem("user"):null,S=A?JSON.parse(A):null;if(!j)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-4",children:"Loading..."})]})});if(!n&&!w)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Admin privileges required to access this page."}),(0,a.jsx)("button",{onClick:()=>window.location.href="/",className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md transition-colors",children:"Return to Home"})]})});let P=s||S;if(P&&"admin"!==P.role)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Admin privileges required to access this page."}),(0,a.jsx)("button",{onClick:()=>window.location.href="/",className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md transition-colors",children:"Return to Home"})]})});let k=()=>localStorage.getItem("token"),E=async()=>{let e=k();if(e)try{p(!0);let t=await fetch("".concat(o,"/admin/stats"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){let e=await t.json();throw Error(e.message||"Stats API error: ".concat(t.status))}let s=await t.json();if(console.log("\uD83D\uDCCA Stats response:",s),s.success)m(s.data);else throw Error(s.message||"Failed to fetch stats");let a=await fetch("".concat(o,"/admin/polls"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok){let e=await a.json();throw Error(e.message||"Polls API error: ".concat(a.status))}let r=await a.json();if(console.log("\uD83D\uDCCB Polls response:",r),r.success)g(r.data);else throw Error(r.message||"Failed to fetch polls")}catch(e){console.error("fetchAdminData error:",e),O("Error fetching admin data: ".concat(e instanceof Error?e.message:"Unknown error"),"error")}finally{p(!1)}},T=async()=>{let e=k();if(e)try{console.log("\uD83D\uDD04 Creating poll:",v);let t=await fetch("".concat(o,"/admin/polls"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(v)});if(console.log("\uD83D\uDCDD Create poll response status:",t.status),!t.ok){let e=await t.json();throw Error(e.message||"API error: ".concat(t.status))}let s=await t.json();if(console.log("\uD83D\uDCDD Create poll response data:",s),s.success)O("Poll created successfully!","success"),N({title:"",description:"",category:"campus-decision",isAnonymous:!0,startTime:"",endTime:"",options:[{text:"",description:""},{text:"",description:""}]}),E(),d("polls");else throw Error(s.message||"Failed to create poll")}catch(e){console.error("Create poll error:",e),O("Error creating poll: ".concat(e instanceof Error?e.message:"Unknown error"),"error")}},C=async e=>{if(!confirm("Are you sure you want to delete this poll? This action cannot be undone."))return;let t=k();if(t)try{let s=await fetch("".concat(o,"/admin/polls/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),a=await s.json();a.success?(O("Poll deleted successfully!","success"),E()):O(a.message||"Failed to delete poll","error")}catch(e){O("Error deleting poll","error")}},D=async()=>{if(!confirm("Are you sure you want to delete ALL polls? This action cannot be undone and will remove all polls from the voting system."))return;let e=k();if(e)try{for(let t of u){let s=t._id||t.id,a=await fetch("".concat(o,"/admin/polls/").concat(s),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to delete poll")}}O("All polls cleared successfully!","success"),E()}catch(e){console.error("Clear polls error:",e),O("Error clearing polls: ".concat(e instanceof Error?e.message:"Unknown error"),"error")}},R=async(e,t)=>{let s=k();if(s)try{let a=await fetch("".concat(o,"/admin/polls/").concat(e,"/toggle"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({isActive:!t})}),r=await a.json();r.success?(O("Poll ".concat(t?"deactivated":"activated"," successfully!"),"success"),E()):O(r.message||"Failed to update poll status","error")}catch(e){O("Error updating poll status","error")}},O=(e,t)=>{y({message:e,type:t}),setTimeout(()=>y(null),5e3)},H=e=>{if(v.options.length>2){let t=v.options.filter((t,s)=>s!==e);N({...v,options:t})}},I=(e,t,s)=>{let a=v.options.map((a,r)=>r===e?{...a,[t]:s}:a);N({...v,options:a})};return s&&"admin"===s.role?x?(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Panel"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage polls and voting system"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Welcome, ",(null==s?void 0:s.firstName)||"Admin"," ",(null==s?void 0:s.lastName)||""]}),(0,a.jsx)("div",{className:"w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-white font-semibold",children:((null==s?void 0:null===(e=s.firstName)||void 0===e?void 0:e.charAt(0))||(null==s?void 0:null===(t=s.email)||void 0===t?void 0:t.charAt(0))||"A").toUpperCase()})]})]})})}),f&&(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4",children:(0,a.jsx)("div",{className:"p-4 rounded-lg ".concat("success"===f.type?"bg-green-100 text-green-800 border border-green-200":"error"===f.type?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:f.message})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 mb-8",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"dashboard",name:"Dashboard",icon:"\uD83D\uDCCA"},{id:"polls",name:"Manage Polls",icon:"\uD83D\uDDF3️"},{id:"create",name:"Create Poll",icon:"➕"},{id:"analytics",name:"Analytics",icon:"\uD83D\uDCC8"}].map(e=>(0,a.jsxs)("button",{onClick:()=>d(e.id),className:"".concat(c===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2"),children:[(0,a.jsx)("span",{children:e.icon}),(0,a.jsx)("span",{children:e.name})]},e.id))})}),"dashboard"===c&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"\uD83D\uDCCA"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Polls"}),(0,a.jsx)("dd",{className:"text-3xl font-semibold text-gray-900",children:h.totalPolls})]})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"✅"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Polls"}),(0,a.jsx)("dd",{className:"text-3xl font-semibold text-gray-900",children:h.activePolls})]})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"\uD83D\uDDF3️"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Votes"}),(0,a.jsx)("dd",{className:"text-3xl font-semibold text-gray-900",children:h.totalVotes})]})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-orange-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"\uD83D\uDC65"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Users"}),(0,a.jsx)("dd",{className:"text-3xl font-semibold text-gray-900",children:h.totalUsers})]})})]})})]}),"polls"===c&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"All Polls"}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:D,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDDD1️"}),(0,a.jsx)("span",{children:"Clear All Polls"})]}),(0,a.jsxs)("button",{onClick:()=>d("create"),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"➕"}),(0,a.jsx)("span",{children:"Create New Poll"})]})]})]}),(0,a.jsx)("div",{className:"grid gap-6",children:u.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h4",{className:"text-xl font-semibold text-gray-900",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"\uD83D\uDFE2 Active":"\uD83D\uDD34 Inactive"}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800",children:e.category.replace("-"," ")})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("span",{children:["\uD83D\uDCCA ",e.totalVotes," votes"]}),(0,a.jsxs)("span",{children:["\uD83D\uDCC5 Created: ",new Date(e.createdAt).toLocaleDateString()]}),(0,a.jsxs)("span",{children:["⏰ Ends: ",new Date(e.endTime).toLocaleDateString()]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>R(e._id,e.isActive),className:"px-3 py-1 text-sm rounded-lg transition-colors ".concat(e.isActive?"bg-red-100 text-red-800 hover:bg-red-200":"bg-green-100 text-green-800 hover:bg-green-200"),children:e.isActive?"Deactivate":"Activate"}),(0,a.jsx)("button",{onClick:()=>C(e._id),className:"px-3 py-1 text-sm bg-red-100 text-red-800 rounded-lg hover:bg-red-200 transition-colors",children:"Delete"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-900",children:"Options:"}),e.options.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.text}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-indigo-600",children:[e.voteCount," votes"]})]},e.id))]})]},e.id))})]}),"create"===c&&(0,a.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Create New Poll"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poll Title *"}),(0,a.jsx)("input",{type:"text",value:v.title,onChange:e=>N({...v,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter poll title..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,a.jsx)("textarea",{value:v.description,onChange:e=>N({...v,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Describe what this poll is about..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,a.jsxs)("select",{value:v.category,onChange:e=>N({...v,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"student-election",children:"Student Election"}),(0,a.jsx)("option",{value:"campus-decision",children:"Campus Decision"}),(0,a.jsx)("option",{value:"feedback",children:"Feedback"})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:v.isAnonymous,onChange:e=>N({...v,isAnonymous:e.target.checked}),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Anonymous Voting"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),(0,a.jsx)("input",{type:"datetime-local",value:v.startTime,onChange:e=>N({...v,startTime:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Time *"}),(0,a.jsx)("input",{type:"datetime-local",value:v.endTime,onChange:e=>N({...v,endTime:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Poll Options * (minimum 2)"}),(0,a.jsxs)("button",{onClick:()=>{N({...v,options:[...v.options,{text:"",description:""}]})},className:"text-indigo-600 hover:text-indigo-700 text-sm font-medium flex items-center space-x-1",children:[(0,a.jsx)("span",{children:"➕"}),(0,a.jsx)("span",{children:"Add Option"})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:v.options.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("h6",{className:"text-sm font-medium text-gray-700",children:["Option ",t+1]}),v.options.length>2&&(0,a.jsx)("button",{onClick:()=>H(t),className:"text-red-600 hover:text-red-700 text-sm",children:"Remove"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",value:e.text,onChange:e=>I(t,"text",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Option text..."}),(0,a.jsx)("input",{type:"text",value:e.description,onChange:e=>I(t,"description",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Optional description..."})]})]},t))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6",children:[(0,a.jsx)("button",{onClick:()=>d("polls"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:T,disabled:!v.title||!v.description||!v.startTime||!v.endTime||v.options.some(e=>!e.text),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Create Poll"})]})]})]})}),"analytics"===c&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Voting Analytics"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Poll Performance"}),(0,a.jsx)("div",{className:"space-y-4",children:u.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[e.totalVotes," votes"]})]}),(0,a.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:"".concat(Math.min(e.totalVotes/Math.max(...u.map(e=>e.totalVotes))*100,100),"%")}})})]},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,a.jsx)("div",{className:"space-y-3",children:u.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-indigo-600 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-900",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})]},e.id))})]})]})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD12"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})})};function o(){return(0,a.jsx)(l.O,{children:(0,a.jsx)("div",{className:"min-h-screen",children:(0,a.jsx)(n,{})})})}},6868:(e,t,s)=>{"use strict";s.d(t,{A:()=>n,O:()=>o});var a=s(5155),r=s(2115),l=s(4639);let i=(0,r.createContext)(void 0),n=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},o=e=>{let{children:t}=e,[s,n]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0),[d,h]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{if((0,l.wR)()){let t=(0,l.HW)();if(t){n(t),h(!0);try{var e;let t=await l.Kp.getProfile();t.success&&(null===(e=t.data)||void 0===e?void 0:e.user)&&n(t.data.user)}catch(e){console.warn("Failed to refresh user data:",e)}}}}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}finally{c(!1)}})()},[]);let m=async(e,t)=>{try{var s;c(!0);let a=await l.Kp.login({email:e,password:t});if(a.success&&(null===(s=a.data)||void 0===s?void 0:s.user))return n(a.data.user),h(!0),{success:!0,message:a.message};return{success:!1,message:a.message||"Login failed"}}catch(e){return console.error("Login error:",e),{success:!1,message:e instanceof Error?e.message:"Login failed"}}finally{c(!1)}},u=async e=>{try{var t;c(!0);let s=await l.Kp.register(e);if(s.success&&(null===(t=s.data)||void 0===t?void 0:t.user))return n(s.data.user),h(!0),{success:!0,message:s.message};return{success:!1,message:s.message||"Registration failed"}}catch(e){return console.error("Registration error:",e),{success:!1,message:e instanceof Error?e.message:"Registration failed"}}finally{c(!1)}},g=async()=>{try{await l.Kp.logout()}catch(e){console.error("Logout error:",e)}finally{n(null),h(!1)}},x=async e=>{try{var t;let s=await l.Kp.updateProfile(e);if(s.success&&(null===(t=s.data)||void 0===t?void 0:t.user))return n(s.data.user),{success:!0,message:s.message};return{success:!1,message:s.message||"Update failed"}}catch(e){return console.error("Update error:",e),{success:!1,message:e instanceof Error?e.message:"Update failed"}}};return(0,a.jsx)(i.Provider,{value:{user:s,loading:o,login:m,register:u,logout:g,updateUser:x,isLoggedIn:d},children:t})}},4639:(e,t,s)=>{"use strict";s.d(t,{HW:()=>n,Kp:()=>l,wR:()=>i});let a=s(2818).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api";class r{getAuthHeaders(){let e=localStorage.getItem("token");return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}async handleResponse(e){let t=await e.json();if(!e.ok){var s;throw Error((null===(s=t.error)||void 0===s?void 0:s.message)||t.message||"An error occurred")}return t}async register(e){var t;let s=await fetch("".concat(a,"/auth/register"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)}),r=await this.handleResponse(s);return r.success&&(null===(t=r.data)||void 0===t?void 0:t.token)&&(localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user))),r}async login(e){var t;let s=await fetch("".concat(a,"/auth/login"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)}),r=await this.handleResponse(s);return r.success&&(null===(t=r.data)||void 0===t?void 0:t.token)&&(localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user))),r}async logout(){let e=await fetch("".concat(a,"/auth/logout"),{method:"POST",headers:this.getAuthHeaders()});return localStorage.removeItem("token"),localStorage.removeItem("user"),this.handleResponse(e)}async getProfile(){let e=await fetch("".concat(a,"/auth/me"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async updateProfile(e){var t;let s=await fetch("".concat(a,"/auth/profile"),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(e)}),r=await this.handleResponse(s);return r.success&&(null===(t=r.data)||void 0===t?void 0:t.user)&&localStorage.setItem("user",JSON.stringify(r.data.user)),r}async askAI(e,t){let s=await fetch("".concat(a,"/ai/ask"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify({question:e,context:t})});return this.handleResponse(s)}async getAIRecommendations(){let e=await fetch("".concat(a,"/ai/recommendations"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async getStudentData(){let e=await fetch("".concat(a,"/students"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async getDashboardAnalytics(){let e=await fetch("".concat(a,"/analytics/dashboard"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async healthCheck(){let e=await fetch("".concat(a,"/health"));return this.handleResponse(e)}async createPortfolio(e){let t=await fetch("".concat(a,"/portfolio"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async getPortfolio(){let e=await fetch("".concat(a,"/portfolio"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async updatePortfolio(e){let t=await fetch("".concat(a,"/portfolio"),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async deletePortfolio(){let e=await fetch("".concat(a,"/portfolio"),{method:"DELETE",headers:this.getAuthHeaders()});return this.handleResponse(e)}async getPublicPortfolio(e){let t=await fetch("".concat(a,"/portfolio/public/").concat(e),{method:"GET"});return this.handleResponse(t)}async getAllPublicPortfolios(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,s=await fetch("".concat(a,"/portfolio/public?page=").concat(e,"&limit=").concat(t),{method:"GET"});return this.handleResponse(s)}async addProject(e){let t=await fetch("".concat(a,"/portfolio/projects"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateProject(e,t){let s=await fetch("".concat(a,"/portfolio/projects/").concat(e),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(s)}async deleteProject(e){let t=await fetch("".concat(a,"/portfolio/projects/").concat(e),{method:"DELETE",headers:this.getAuthHeaders()});return this.handleResponse(t)}async addSkill(e){let t=await fetch("".concat(a,"/portfolio/skills"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async deleteSkill(e){let t=await fetch("".concat(a,"/portfolio/skills/").concat(e),{method:"DELETE",headers:this.getAuthHeaders()});return this.handleResponse(t)}async addAchievement(e){let t=await fetch("".concat(a,"/portfolio/achievements"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async deleteAchievement(e){let t=await fetch("".concat(a,"/portfolio/achievements/").concat(e),{method:"DELETE",headers:this.getAuthHeaders()});return this.handleResponse(t)}async tryDemo(e){let t=await fetch("".concat(a,"/demo/").concat(e),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify({demoType:e})});return this.handleResponse(t)}async getActivePolls(){let e=await fetch("".concat(a,"/voting/polls/active"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async getPollDetails(e){let t=await fetch("".concat(a,"/voting/polls/").concat(e),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(t)}async castVote(e,t){let s=await fetch("".concat(a,"/voting/vote"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify({pollId:e,optionId:t})});return this.handleResponse(s)}async getPollResults(e){let t=await fetch("".concat(a,"/voting/polls/").concat(e,"/results"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(t)}async createPoll(e){let t=await fetch("".concat(a,"/voting/polls"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async getSchedule(e,t,s){let r="".concat(a,"/schedule"),l=new URLSearchParams;e&&l.append("startDate",e),t&&l.append("endDate",t),s&&l.append("type",s),l.toString()&&(r+="?".concat(l.toString()));let i=await fetch(r,{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(i)}async createScheduleItem(e){let t=await fetch("".concat(a,"/schedule/items"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async updateScheduleItem(e,t){let s=await fetch("".concat(a,"/schedule/items/").concat(e),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(t)});return this.handleResponse(s)}async deleteScheduleItem(e){let t=await fetch("".concat(a,"/schedule/items/").concat(e),{method:"DELETE",headers:this.getAuthHeaders()});return this.handleResponse(t)}async getSmartSuggestions(){let e=await fetch("".concat(a,"/schedule/suggestions"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}async createStudySession(e){let t=await fetch("".concat(a,"/schedule/study-sessions"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return this.handleResponse(t)}async getScheduleAnalytics(){let e=await fetch("".concat(a,"/schedule/analytics"),{method:"GET",headers:this.getAuthHeaders()});return this.handleResponse(e)}}let l=new r,i=()=>!!localStorage.getItem("token"),n=()=>{let e=localStorage.getItem("user");try{return e?JSON.parse(e):null}catch(e){return null}}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(6181)),_N_E=e.O()}]);